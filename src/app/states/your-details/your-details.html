<back-link></back-link>


<div class="grid-row">


  <div class="column-two-thirds">


    <h1 class="heading-xlarge">Your details</h1>


    <error-summary
      form="vm.form"
      fields="[
        {
          name: 'correct-details',
          label: 'Are these details correct?'
        },
        {
          name: 'your-update-details',
          label: 'Enter correct details'
        },
        {
          name: 'contact-number',
          label: 'Contact number'
        },
        {
          name: 'email-address',
          label: 'Email address (optional)'
        },
        {
          name: 'dob-day',
          scrollToId: 'error-dob',
          focusId: 'error-dob',
          label: 'Your date of birth'
        },
        {
          name: 'national-insurance',
          label: 'Do you have a National Insurance number?'
        },
        {
          name: 'national-insurance-number',
          label: 'National Insurance number'
        }
      ]">
    </error-summary>


    <p class="lede">We may need to contact you about your plea.</p>


    <form class="form" method="post" name="vm.form" autocomplete="off" novalidate data-form-selection>


      <h2 class="heading-medium">Check your name and address</h2>


      <div class="panel panel-border-wide">

        <p>
          <span class="bold-small">{{vm.defendantDetails.title}} {{vm.defendantDetails.firstName}} {{vm.defendantDetails.lastName}}</span><br>
          {{vm.defendantDetails.address.street}}<br>
          {{vm.defendantDetails.address.city}}<br>
          {{vm.defendantDetails.address.postcode}}
        </p>

      </div>


      <div class="form-group">

        <fieldset class="inline" data-ng-class="{'error': vm.form['correct-details'].invalid}">

          <legend id="error-correct-details">
            <span class="form-label-bold">Are these details correct?</span>
            <span class="error-message" id="error-message-correct-details" data-ng-show="vm.form['correct-details'].invalid">Choose an answer</span>
          </legend>

          <label class="block-label" for="correct-details-yes" data-ng-class="{ 'selected': vm.formData.detailsCorrect.yes === true }">
            <input type="radio" id="correct-details-yes" name="correct-details" ng-value="true" required aria-required="true"
                   data-ng-attr-aria-invalid="{{vm.form['correct-details'].invalid ? 'true' : undefined}}"
                   data-ng-attr-aria-describedby="{{vm.form['correct-details'].invalid ? 'error-message-correct-details' : undefined}}"
                   data-ng-model="vm.formData.detailsCorrect.yes"> Yes
          </label>

          <label class="block-label" for="correct-details-no" data-ng-class="{ 'selected': vm.formData.detailsCorrect.yes === false }">
            <input type="radio" id="correct-details-no" name="correct-details" ng-value="false" required aria-required="true" aria-controls="correct-details"
                   data-ng-attr-aria-invalid="{{vm.form['correct-details'].invalid ? 'true' : undefined}}"
                   data-ng-attr-aria-expanded="{{(vm.formData.detailsCorrect.yes === false) ? 'true' : 'false'}}"
                   data-ng-model="vm.formData.detailsCorrect.yes"> No
          </label>

        </fieldset>

        <div class="panel panel-border-narrow" id="correct-details"
             data-ng-class="{ 'js-hidden': vm.formData.detailsCorrect.yes !== false }"
             data-ng-attr-aria-hidden="{{vm.formData.detailsCorrect.yes !== false ? 'true' : 'false'}}">

          <div class="form-group" data-ng-class="{'error': vm.form['your-update-details'].invalid}">

            <label for="your-update-details" id="error-your-update-details">
              <span class="form-label">Enter correct details</span>
              <span class="error-message" id="error-message-your-update-details" data-ng-show="vm.form['your-update-details'].invalid">Provide this information</span>
            </label>

            <textarea class="form-control form-control-textarea" id="your-update-details" name="your-update-details" cols="30" rows="3"
                      data-ng-attr-aria-invalid="{{vm.form['your-update-details'].invalid ? 'true' : undefined}}"
                      data-ng-attr-aria-describedby="{{vm.form['your-update-details'].invalid ? 'error-message-your-update-details' : undefined}}"
                      data-ng-attr-aria-required="vm.formData.detailsCorrect.yes === false"
                      data-ng-required="vm.formData.detailsCorrect.yes === false"
                      data-ng-model="vm.formData.detailsCorrect.correctDetails"></textarea>

          </div>

        </div>
      
      </div>


      <h2 class="heading-medium">Enter other details</h2>


      <div class="form-group" data-ng-class="{'error': vm.form['contact-number'].invalid}">
        <label for="contact-number" id="error-contact-number" data-ng-messages="vm.form['contact-number'].error">
          <span class="form-label-bold">Contact number</span>
          <span class="form-hint" id="contact-number-hint">Landline or mobile number</span>
          <span class="error-message" id="error-message-contact-number" data-ng-message="required">Provide this information</span>
          <span class="error-message" id="error-message-contact-number" data-ng-message="pattern">Number not valid &ndash; enter number</span>
        </label>

        <input class="form-control form-control-1-3" type="tel" id="contact-number" name="contact-number" required aria-required="true"
               data-ng-attr-aria-invalid="{{vm.form['contact-number'].invalid ? 'true' : undefined}}"
               data-ng-attr-aria-describedby="{{vm.form['contact-number'].invalid ? 'error-message-contact-number' : 'contact-number-hint'}}"
               data-ng-pattern="vm.ukTelephoneNumberRegex"
               data-ng-model="vm.formData.contactNumber">

      </div>
      
      
      <div class="form-group" data-ng-class="{'error': vm.form['email-address'].invalid}">

        <label for="email-address" id="error-email-address">
          <span class="form-label-bold">Email address (optional)</span>
          <span class="form-hint" id="email-address-hint">If you provide this, we&rsquo;ll automatically email you a copy of your plea</span>
          <span class="error-message" id="error-message-email-address" data-ng-show="vm.form['email-address'].invalid">Email not valid &ndash; enter address</span>
        </label>

        <input class="form-control form-control-1-3" type="text" id="email-address" name="email-address"
               data-ng-attr-aria-invalid="{{vm.form['email-address'].invalid ? 'true' : undefined}}"
               data-ng-attr-aria-describedby="{{vm.form['email-address'].invalid ? 'error-message-email-address' : 'email-address-hint'}}"
               data-ng-pattern="vm.emailAddressRegex"
               data-ng-model="vm.formData.email">

      </div>


      <div class="form-group" data-ng-class="{'error': vm.form['dob-day'].invalid}">

        <fieldset>

          <form-fieldset-legend
            data-base-id="dob"
            data-label="Your date of birth"
            data-hint="For example, 31 3 1980"
            data-form-field="vm.form['dob-day']"
            data-error-messages="[
              {
                name: 'allRequired',
                text: 'Provide this information'
              },
              {
                name: 'invalidDayOfMonth',
                text: 'Date not recognised &ndash; use format, for example 31 3 1980'
              },
              {
                name: 'invalidMonth',
                text: 'Date not recognised &ndash; use format, for example 31 3 1980'
              },
              {
                name: 'inFuture',
                text: 'Date can&rsquo;t be in future &ndash; enter valid date'
              },
              {
                name: 'inPast',
                text: 'Date can&rsquo;t be in past &ndash; enter valid date'
              },
              {
                name: 'atLeast18',
                text: 'Age too young &ndash; enter valid date of birth'
              },
              {
                name: 'number',
                text: 'Date not recognised &ndash; use format, for example 31 3 1980'
              }
            ]">
          </form-fieldset-legend>


          <div class="form-date">

            <div class="form-group form-group-day">
              <label for="dob-day">Day</label>
              <input class="form-control" type="number" id="dob-day" max="31" min="1" pattern="[0-9]{1,2}" name="dob-day" required aria-required="true"
                     data-ng-attr-aria-invalid="{{vm.form['dob-day'].invalid ? 'true' : undefined}}"
                     data-ng-attr-aria-describedby="{{vm.form['dob-day'].invalid ? 'error-message-dob' : 'dob-hint'}}"
                     data-ui-validate="{
                        allRequired : 'vm.allRequired(vm.form[\'dob-year\'], vm.form[\'dob-month\'], vm.form[\'dob-day\'])',
                        invalidDayOfMonth : 'vm.invalidDayOfMonth(vm.form[\'dob-year\'], vm.form[\'dob-month\'], vm.form[\'dob-day\'])',
                        invalidMonth : 'vm.invalidMonth(vm.form[\'dob-month\'])',
                        inPast : 'vm.inPast(vm.form[\'dob-year\'], vm.form[\'dob-month\'], vm.form[\'dob-day\'], 1900)',
                        inFuture : 'vm.inFuture(vm.form[\'dob-year\'], vm.form[\'dob-month\'], vm.form[\'dob-day\'])',
                        atLeast18 : 'vm.atLeast(vm.form[\'dob-year\'], vm.form[\'dob-month\'], vm.form[\'dob-day\'], 18)'
                     }"
                     data-ng-model="vm.formData.dateOfBirth.day">
            </div>

            <div class="form-group form-group-month">
              <label for="dob-month">Month</label>
              <input class="form-control" type="number" id="dob-month" max="12" min="1" pattern="[0-9]{1,2}" name="dob-month" required aria-required="true"
                     data-ng-attr-aria-invalid="{{vm.form['dob-day'].invalid ? 'true' : undefined}}"
                     data-ui-validate="'vm.validateDay(vm.form[\'dob-day\'])'"
                     data-ng-model="vm.formData.dateOfBirth.month">
            </div>

            <div class="form-group form-group-year">
              <label for="dob-year">Year</label>
              <input class="form-control" type="number" id="dob-year" max="2050" min="1900" pattern="[0-9]{4}" name="dob-year" required aria-required="true"
                     data-ng-attr-aria-invalid="{{vm.form['dob-day'].invalid ? 'true' : undefined}}"
                     data-ui-validate="'vm.validateDay(vm.form[\'dob-day\'])'"
                     data-ng-model="vm.formData.dateOfBirth.year">
            </div>

          </div>

        </fieldset>

      </div>


      <div class="form-group">

        <fieldset class="inline" data-ng-class="{'error': vm.form['national-insurance'].invalid}">
  
          <legend id="error-national-insurance">
            <span class="form-label-bold">Do you have a National Insurance number?</span>
            <span class="error-message" id="error-message-national-insurance" data-ng-show="vm.form['national-insurance'].invalid">Choose an answer</span>
          </legend>

          <label class="block-label" for="national-insurance-yes" data-ng-class="{ 'selected': vm.formData.nationalInsuranceNumber.yes === true }">
            <input type="radio" id="national-insurance-yes" name="national-insurance" ng-value="true" required aria-required="true" aria-controls="national-insurance"
                   data-ng-attr-aria-invalid="{{vm.form['national-insurance'].invalid ? 'true' : undefined}}"
                   data-ng-attr-aria-describedby="{{vm.form['national-insurance'].invalid ? 'error-message-national-insurance' : undefined}}"
                   data-ng-attr-aria-expanded="{{vm.formData.nationalInsuranceNumber.yes === true ? 'true' : 'false'}}"
                   data-ng-model="vm.formData.nationalInsuranceNumber.yes"> Yes
          </label>

          <label class="block-label" for="national-insurance-no" data-ng-class="{ 'selected': vm.formData.nationalInsuranceNumber.yes === false }">
            <input type="radio" id="national-insurance-no" name="national-insurance" ng-value="false" required aria-required="true"
                   data-ng-attr-aria-invalid="{{vm.form['national-insurance'].invalid ? 'true' : undefined}}"
                   data-ng-model="vm.formData.nationalInsuranceNumber.yes"> No
          </label>
  
        </fieldset>
        
        <div class="panel panel-border-narrow" id="national-insurance"
             data-ng-class="{'js-hidden': vm.formData.nationalInsuranceNumber.yes !== true}"
             data-ng-attr-aria-hidden="{{vm.formData.nationalInsuranceNumber.yes !== true ? 'true' : 'false'}}">

          <div class="form-group" data-ng-class="{'error': vm.form['national-insurance-number'].invalid}" data-ng-messages="vm.form['national-insurance-number'].error">

            <label for="national-insurance-number" id="error-national-insurance-number">
              <span class="form-label">National Insurance number</span>
              <span class="form-hint" id="national-insurance-number-hint">Find this on your payslip, P60 or tax return. <br> For example, VO 12 34 56 D.</span>
              <span class="error-message" id="error-message-national-insurance-number" data-ng-message="required">Provide this information</span>
              <span class="error-message" id="error-message-national-insurance-number" data-ng-message="pattern">Number not valid &ndash; enter correct format. <br> For example, VO 12 34 56 D.</span>
            </label>

            <input class="form-control" type="text" id="national-insurance-number" name="national-insurance-number"
                   data-ng-attr-aria-invalid="{{vm.form['national-insurance-number'].invalid ? 'true' : undefined}}"
                   data-ng-attr-aria-describedby="{{vm.form['national-insurance-number'].invalid ? 'error-message-national-insurance-number' : 'national-insurance-number-hint'}}"
                   data-ng-attr-aria-required="vm.formData.nationalInsuranceNumber.yes === true"
                   data-ng-required="vm.formData.nationalInsuranceNumber.yes === true"
                   data-ui-validate="{pattern: 'vm.validateNationalInsuranceNumber($value)'}"
                   data-ng-model="vm.formData.nationalInsuranceNumber.NI">

          </div>

        </div>
      
      </div>


      <div class="form-group">

        <button class="button" type="submit" 
          data-ng-click="vm.buttonContinue($event)" 
          data-focus-event="click" 
          data-focus-target="error-summary"
          data-focus>Continue
        </button>

      </div>


      <p data-ng-show="vm.nextState"><a href="" data-ui-sref="{{vm.getNextState()}}">Cancel</a></p>


    </form>


  </div>


</div>
